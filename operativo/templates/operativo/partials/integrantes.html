{% load static %}
<div class="integrantes">
  <h2>Seleccionar Integrantes</h2>
  <div class="integrantes-grid">
    <!-- Columna izquierda - Búsqueda y lista -->
    <div class="columna-izquierda">
      <!-- Buscador -->
      <div class="seccion-buscador">
        <h3>Buscar Integrantes</h3>
        <form method="get" class="buscador-form">
          <div class="input-group">
            <input
              type="text"
              name="q"
              placeholder="Buscar por nombre, puesto o área..."
              value="{{ request.GET.q }}"
              class="input-text"
            />
            <button type="submit" class="btn btn-buscar">
              <span>🔍</span> Buscar
            </button>
          </div>
        </form>
      </div>

      <!-- Lista de integrantes -->
      <div class="seccion-lista">
        <h3>Lista de Integrantes Disponibles</h3>
        <select
          id="integrantesSelect"
          multiple
          size="8"
          class="select-multiple"
        >
          {% for integrante in integrantes %}
          <option value="{{ integrante.id }}">
            {{ integrante.nombre_completo }} - {{ integrante.puesto }} ({{ integrante.area.nombre }})
          </option>
          {% empty %}
          <option disabled>No hay integrantes disponibles</option>
          {% endfor %}
        </select>

        <button
          type="button"
          id="agregarSeleccionados"
          class="btn-secundario"
        >
          ➕ Agregar Seleccionados
        </button>
      </div>
    </div>

    <!-- Columna derecha - Seleccionados y agregar -->
    <div class="columna-derecha">
      <!-- Integrantes seleccionados -->
      <div class="seccion-seleccionados">
        <div class="seleccionados-header">
          <h3>Integrantes Seleccionados</h3>
          <span id="contadorSeleccionados" class="contador">({{ seleccionados|length }})</span>
        </div>
        <ul id="listaSeleccionados" class="lista-seleccionados">
          {% for integrante in seleccionados %}
          <li data-id="{{ integrante.id }}">
            <span class="integrante-info">
              <strong>{{ integrante.nombre_completo }}</strong>
              <span class="integrante-detalles">
                {{ integrante.puesto }} • {{ integrante.area.nombre }}
              </span>
            </span>
            <button class="eliminarBtn btn-eliminar" type="button" title="Eliminar">
              ✕
            </button>
          </li>
          {% empty %}
          <li id="mensajeVacio" class="mensaje-vacio">
            <span>No hay integrantes seleccionados</span>
          </li>
          {% endfor %}
        </ul>
      </div>

      <!-- Formulario para guardar seleccionados -->
      <form method="post" id="formGuardarSeleccion">
        {% csrf_token %}
        <button type="submit" class="btn btn-guardar">💾 Guardar Seleccionados</button>
      </form>

      <!-- Formulario para agregar nuevo integrante -->
      <div class="seccion-agregar">
        <h3>Agregar Nuevo Integrante</h3>
        <form method="post" class="agregar-form">
          {% csrf_token %}
          <div class="form-container">{{ form.as_p }}</div>
          <button type="submit" name="agregar_integrante" class="btn btn-agregar">
            👥 Agregar Integrante
          </button>
        </form>
      </div>
    </div>
  </div>
</div>
